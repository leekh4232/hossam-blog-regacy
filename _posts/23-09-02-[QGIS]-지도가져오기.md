---
layout: post
title:  "[QGIS] (Lab01)-지도 가져오기"
date:   2023-09-02
banner_image: index-qgis.png
tags: [QGIS]
---

QGIS는 shape, image 등의 지도를 사용하여 지리정보를 다룰 수 있습니다.

<!--more-->

# #01. shape 지도

shape 지도는 검색을 통해 다운로드 받는다. 대부분 관공서 등에서 공공 데이터 형식으로 배포한다.

국가공간정보포털(http://www.nsdi.go.kr/)에서 검색 후 내려받을 수 있다.

![img](/images/posts/2023/0902/site.png)

내려받은 파일의 압축을 해제하면 `*.dbf`, `*.prj`, `*.shp`, `*.shx` 4개의 파일이 포함되어 있다. 이 4파일이 한 셋트이므로 반드시 동일 폴더안에 포함되어 있어야 한다.

### 1. shape 파일의 구성

| 포멧 | 설명 |
|---|---|
| `*.dbf` | 각 도형의 속성 정보가 저장되어 있는 파일 |
| `*.prj` | 좌표정보가 저장되어 있다 |
| `*.shp` | 쉐이프 포멧. 도형파일(벡터형식) |
| `*.shx` | 쉐이프 인덱스 포멧. 도형의 위치, 방향 정보가 저장되어 있다 |

### 2. GeoJson

`*.shp`을 JSON 형식으로 내보낸 형태.

주로 웹 프로그램에서 활용하기 위한 용도

### 3. shape 파일 가져오기 실습

#### 1) 프로젝트 생성 및 저장

`프로젝트 > 새로 생성`을 선택하여 빈 프로젝트 생성 (프로그램 실행 직후에는 새로 생성할 필요는 없음)

`프로젝트 > 저장` 메뉴를 선택하여 일단 저장한다.

> 여기서는 작업폴더안에 Lab01 폴더를 만들고 `지도불러오기.qgz`로 저장함

#### 2) 지도 파일을 작업 공간에 넣기

`LARD_ADM_SECT_SGG_서울.zip`파일의 압축을 해제하여 작업폴더 안에 `Lab01`이라는 이름으로 배치한다.

![img](/images/posts/2023/0902/work01.png)

#### 3) 지도 레이어 추가

탐색기에서 지도 파일을 찾아 더블클릭한다.

![img](/images/posts/2023/0902/work02.png)

#### 4) shape 파일 살펴보기

> 내용 추가 필요

# #02. 배경지도

shape 뒤에 배경으로 배치되는 지도

대체로 이미지, 구글맵, 네이버 지도 등을 배경으로 설정할 수 있다.

## 1. 이미지 타일지도

하나의 이미지가 아닌 복수개의 지도이미지를 사용자가 원하는 영역에 축척별로 다운로드 받아 사용하는 것

## 2. 이미지 타일지도 실습

### 1) 새 연결 생성

#### `XYZ 연결창` 열기

탐색기에서 `XYZ Tiles` 항목을 우클릭하고 `새 연결` 선택

![img](/images/posts/2023/0902/work03.png)

#### 값 설정

`XYZ 연결` 창이 표시되면 `이름`과 `URL`을 입력하고 확인 버튼 클릭

| 항목 | 값 |
|---|---|
| 이름 | Google (자유롭게 설정 가능) |
| URL | https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z} |

![img](/images/posts/2023/0902/work04.png)

#### 지도 레이어 추가

왼쪽의 탐색기에 추가된 `Google` 항목을 더블클릭하면 `레이어`로 추가된다.

레이어 창에서 지도의 순서를 드래그하여 조절할 수 있다.

![img](/images/posts/2023/0902/work05.png)

#### 결과화면

![img](/images/posts/2023/0902/work06.png)

## 3. 이미지 타일지도 일괄 등록하기

파이썬 스크립트를 사용하면 이미지 타일 지도를 일괄 등록할 수 있다.

`플러그인 > 파이썬 콘솔` 메뉴를 선택하고 콘솔창 하단 영역에 아래의 파이썬 소스코드를 붙여 넣는다.

![img](/images/posts/2023/0902/work07.png)

```py
"""
This script should be run from the Python consol inside QGIS.

It adds online sources to the QGIS Browser.
Each source should contain a list with the folowing items (string type):
[sourcetype, title, authconfig, password, referer, url, username, zmax, zmin]

You can add or remove sources from the sources section of the code.

Script by Klas Karlsson
Sources from https://qms.nextgis.com/

Licence GPL-3
"""


# Sources
sources = []
sources.append(["connections-xyz","구글 일반도","","","","https://mt1.google.com/vt/lyrs=m&x=%7Bx%7D&y=%7By%7D&z=%7Bz%7D","","19","0"])
sources.append(["connections-xyz","구글 위성영상", "", "", "", "https://mt1.google.com/vt/lyrs=s&x=%7Bx%7D&y=%7By%7D&z=%7Bz%7D", "", "19", "0"])
sources.append(["connections-xyz","구글 지형도", "", "", "", "https://mt1.google.com/vt/lyrs=t&x=%7Bx%7D&y=%7By%7D&z=%7Bz%7D", "", "19", "0"])
sources.append(["connections-xyz","구글 지형도(하이브리드)", "", "", "", "https://mt1.google.com/vt/lyrs=p&x=%7Bx%7D&y=%7By%7D&z=%7Bz%7D", "", "19", "0"])
sources.append(["connections-xyz","구글 위성지도", "", "", "", "https://mt1.google.com/vt/lyrs=y&x=%7Bx%7D&y=%7By%7D&z=%7Bz%7D", "", "19", "0"])
sources.append(["connections-xyz","Stamen 지형도", "", "", "Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL", "http://tile.stamen.com/terrain/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "0"])
sources.append(["connections-xyz","Stamen 인쇄체(toner)", "", "", "Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL", "http://tile.stamen.com/toner/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "0"])
sources.append(["connections-xyz","Stamen 옅은 인쇄체(light toner)", "", "", "Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL", "http://tile.stamen.com/toner-lite/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "0"])
sources.append(["connections-xyz","Stamen 수채화", "", "", "Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under ODbL", "http://tile.stamen.com/watercolor/%7Bz%7D/%7Bx%7D/%7By%7D.jpg", "", "18", "0"])
sources.append(["connections-xyz","Wikimedia Map", "", "", "OpenStreetMap contributors, under ODbL", "https://maps.wikimedia.org/osm-intl/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "1"])
sources.append(["connections-xyz","Wikimedia Hike Bike Map", "", "", "OpenStreetMap contributors, under ODbL", "http://tiles.wmflabs.org/hikebike/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "17", "1"])
sources.append(["connections-xyz","Esri Boundaries Places", "", "", "", "https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "20", "0"])
sources.append(["connections-xyz","Esri Gray (dark)", "", "", "", "http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "16", "0"])
sources.append(["connections-xyz","Esri Gray (light)", "", "", "", "http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "16", "0"])
sources.append(["connections-xyz","Esri National Geographic", "", "", "", "http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "12", "0"])
sources.append(["connections-xyz","Esri Ocean", "", "", "", "https://services.arcgisonline.com/ArcGIS/rest/services/Ocean/World_Ocean_Base/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "10", "0"])
sources.append(["connections-xyz","Esri Satellite", "", "", "", "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "17", "0"])
sources.append(["connections-xyz","Esri Standard", "", "", "", "https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "17", "0"])
sources.append(["connections-xyz","Esri Terrain", "", "", "", "https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "13", "0"])
sources.append(["connections-xyz","Esri Transportation", "", "", "", "https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "20", "0"])
sources.append(["connections-xyz","Esri Topo World", "", "", "", "http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D", "", "20", "0"])
sources.append(["connections-xyz","오픈스트리트맵 일반도", "", "", "OpenStreetMap contributors, CC-BY-SA", "http://tile.openstreetmap.org/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "19", "0"])
sources.append(["connections-xyz","오픈스트리트맵 일반도(H.O.T)", "", "", "OpenStreetMap contributors, CC-BY-SA", "http://tile.openstreetmap.fr/hot/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "19", "0"])
sources.append(["connections-xyz","오픈스트리트맵 회색조", "", "", "OpenStreetMap contributors, CC-BY-SA", "http://tiles.wmflabs.org/bw-mapnik/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "19", "0"])
sources.append(["connections-xyz","Strava All", "", "", "OpenStreetMap contributors, CC-BY-SA", "https://heatmap-external-b.strava.com/tiles/all/bluered/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "15", "0"])
sources.append(["connections-xyz","Strava Run", "", "", "OpenStreetMap contributors, CC-BY-SA", "https://heatmap-external-b.strava.com/tiles/run/bluered/%7Bz%7D/%7Bx%7D/%7By%7D.png?v=19", "", "15", "0"])
sources.append(["connections-xyz","Open Weather Map Temperature", "", "", "Map tiles by OpenWeatherMap, under CC BY-SA 4.0", "http://tile.openweathermap.org/map/temp_new/%7Bz%7D/%7Bx%7D/%7By%7D.png?APPID=1c3e4ef8e25596946ee1f3846b53218a", "", "19", "0"])
sources.append(["connections-xyz","Open Weather Map Clouds", "", "", "Map tiles by OpenWeatherMap, under CC BY-SA 4.0", "http://tile.openweathermap.org/map/clouds_new/%7Bz%7D/%7Bx%7D/%7By%7D.png?APPID=ef3c5137f6c31db50c4c6f1ce4e7e9dd", "", "19", "0"])
sources.append(["connections-xyz","Open Weather Map Wind Speed", "", "", "Map tiles by OpenWeatherMap, under CC BY-SA 4.0", "http://tile.openweathermap.org/map/wind_new/%7Bz%7D/%7Bx%7D/%7By%7D.png?APPID=f9d0069aa69438d52276ae25c1ee9893", "", "19", "0"])
sources.append(["connections-xyz","CartoDb Dark Matter", "", "", "Map tiles by CartoDB, under CC BY 3.0. Data by OpenStreetMap, under ODbL.", "http://basemaps.cartocdn.com/dark_all/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "0"])
sources.append(["connections-xyz","CartoDb Positron", "", "", "Map tiles by CartoDB, under CC BY 3.0. Data by OpenStreetMap, under ODbL.", "http://basemaps.cartocdn.com/light_all/%7Bz%7D/%7Bx%7D/%7By%7D.png", "", "20", "0"])
sources.append(["connections-xyz","Bing 버츄얼 어스", "", "", "", "http://ecn.t3.tiles.virtualearth.net/tiles/a{q}.jpeg?g=1", "", "19", "1"])
sources.append(["connections-xyz","브이월드 일반도", "", "", "", "http://xdworld.vworld.kr:8080/2d/Base/201710/{z}/{x}/{y}.png", "", "18", "6"])
sources.append(["connections-xyz","브이월드 위성영상", "", "", "", "http://xdworld.vworld.kr:8080/2d/Satellite/201710/{z}/{x}/{y}.jpeg", "", "18", "6"])
sources.append(["connections-xyz","브이월드 하이브리드(위성영상 중첩용)", "", "", "", "http://xdworld.vworld.kr:8080/2d/Hybrid/201710/{z}/{x}/{y}.png", "", "18", "6"])
sources.append(["connections-xyz","브이월드 회색조", "", "", "", "http://xdworld.vworld.kr:8080/2d/gray/201710/{z}/{x}/{y}.png", "", "18", "6"])
sources.append(["connections-xyz","브이월드 야간", "", "", "", "http://xdworld.vworld.kr:8080/2d/midnight/201710/{z}/{x}/{y}.png", "", "18", "6"])



# Add sources to browser
for source in sources:
   connectionType = source[0]
   connectionName = source[1]
   QSettings().setValue("qgis/%s/%s/authcfg" % (connectionType, connectionName), source[2])
   QSettings().setValue("qgis/%s/%s/password" % (connectionType, connectionName), source[3])
   QSettings().setValue("qgis/%s/%s/referer" % (connectionType, connectionName), source[4])
   QSettings().setValue("qgis/%s/%s/url" % (connectionType, connectionName), source[5])
   QSettings().setValue("qgis/%s/%s/username" % (connectionType, connectionName), source[6])
   QSettings().setValue("qgis/%s/%s/zmax" % (connectionType, connectionName), source[7])
   QSettings().setValue("qgis/%s/%s/zmin" % (connectionType, connectionName), source[8])

# Update GUI
iface.reloadConnections()
```

#### 결과화면

![img](/images/posts/2023/0902/work08.png)

# #03. TMS for Korea 플러그인 

네이버 또는 다음 지도를 불러올 수 있도록 하는 플러그인

## 1. 플러그인 설치 실습

메뉴바에서 `플러그인 > 플러그인 관리 및 설치` 메뉴를 선택한다.

왼쪽의 트리에서 `모두`를 선택하고 검색어로 `TMS for Korea`를 입력한다.

![img](/images/posts/2023/0902/work09.png)

검색 된 결과를 설치한다.

설치가 완료되면 메뉴바에서 `웹 > TMS for Korea`의 하위 메뉴에서 Naver, Daum 지도 등을 확인할 수 있다.

> 네이버지도는 표시가 잘 되지 않음, 카카오 지도는 표시 잘 됨

## 2. 레이어 삭제

사용하지 않는 레이어는 우측의 체크박스를 해제하여 표시하지 않거나 마우스 우클릭하여 제거할 수 있다.

![img](/images/posts/2023/0902/work10.png)