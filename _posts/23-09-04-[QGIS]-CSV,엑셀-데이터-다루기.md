---
layout: post
title: "[QGIS] CSV,엑셀 데이터 다루기"
date: 2023-09-04
banner_image: index-qgis.png
tags: [QGIS]
---

QGIS의 데이터 파일 종류에는 벡터데이터(shp파일), 레스터데이터(일반 이미지), 텍스트 데이터(csv), 엑셀 데이터 등이 있습니다.

<!--more-->

# #01. 작업준비

작업폴더 안에 `Lab03` 폴더를 생성하고 **경상남도 읍면동 단위 행정경계 shp 파일** (`LSMD_ADM_SECT_UMD_48_202309`)을 프로젝트 작업폴더 안에 배치한다.

수업시간에 배포되는 xlsx, csv, png 형식의 파일들도 작업폴더에 배치한다.

임의의 프로젝트를 생성한 후 `Lab03` 폴더에 저장한다.

![img](/images/posts/2023/0904/work00.png)

# #02. 경상남도 읍면동 지도 추가

## 1. 벡터 레이어 추가

탐색기에서 shp 파일을 더블클릭하여 지도 레이어에 추가한다

![img](/images/posts/2023/0904/work01.png)

## 2. 레이어 이름 변경

추가된 레이어를 마우스로 우클릭하여 `속성`을 선택하여 `레이어 속성`창을 연다.

`레이어 속성`창의 왼쪽 메뉴에서 `원본` 메뉴를 선택한 후 `레이어 이름`을 임의의 이름으로 지정하고 저장한다.

![img](/images/posts/2023/0904/work02.png)

## 3. 레이어 인코딩 변경

### 속성 테이블 확인

만약 `속성 테이블`을 열었을 때 아래와 같이 한글이 깨진다면 파일의 인코딩이 현재 시스템과 맞지 않는 경우이다.

![img](/images/posts/2023/0904/work03.png)

### 인코딩 변경

이 경우 파일 인코딩을 `속성`창에서 수정할 수 있다.

파일 인코딩이 `UTF-8`로 설정되어 있으면서 한글이 깨진다면 `EUC-KR`로 변경하고 `EUC-KR`로 설정된 상태에서 한글이 깨지고 있다면 `UTF-8`로 변경한다.

![img](/images/posts/2023/0904/work04.png)

## 4. 특정 지역만 추출하기

### 1) 행정구역 구분

#### 법정동

법률에 따라 만들어진 행정구역 단위로서 1914년에 행정구역 통폐합을 거치면서 만들어진 단위이다.

옛 지역의 이름을 그대로 이어와서 사용하고 있는 것이 특징며, 주소를 표기할 때나, 모든 법적 서류에 들어가는 주소로 법정동을 사용하고 있다.

#### 행정동

법으로 정해둔 행정구역이 넓어서 주민들이 가까운 주민센터를 이용하도록 편의상 만든 단위.

행정동은 인구수에 따라 정해지는데 인구가 적은 곳은 다른 법정동과 합쳐서 관리하고, 인구가 많은 법정동은 구획을 나눠 별도로 관리한다.

### 2) 법정동 코드

우리나라의 행정구역을 의미하는 숫자값 체계

속성 테이블에서 `COL_ADM_SE` 필드가 법정동 코드 값이다.

![img](/images/posts/2023/0904/work05.png)

우리 나라의 전체 법정동 코드는 아래 표와 같다.

| 시군구명 | 시군구_코드_법정동기준 | 시군구명 | 시군구_코드_법정동기준 |
|----------|--------------|-----------|--------------|
| 서울 강남구 | 11680 | 원주시 | 42130 |
| 서울 강동구 | 11740 | 인제군 | 42810 |
| 서울 강북구 | 11305 | 정선군 | 42770 |
| 서울 강서구 | 11500 | 철원군 | 42780 |
| 서울 관악구 | 11620 | 춘천시 | 42110 |
| 서울 광진구 | 11215 | 태백시 | 42190 |
| 서울 구로구 | 11530 | 평창군 | 42760 |
| 서울 금천구 | 11545 | 홍천군 | 42720 |
| 서울 노원구 | 11350 | 화천군 | 42790 |
| 서울 도봉구 | 11320 | 횡성군 | 42730 |
| 서울 동대문구 | 11230 | 괴산군 | 43760 |
| 서울 동작구 | 11590 | 단양군 | 43800 |
| 서울 마포구 | 11440 | 보은군 | 43720 |
| 서울 서대문구 | 11410 | 영동군 | 43740 |
| 서울 서초구 | 11650 | 옥천군 | 43730 |
| 서울 성동구 | 11200 | 음성군 | 43770 |
| 서울 성북구 | 11290 | 제천시 | 43150 |
| 서울 송파구 | 11710 | 증평군 | 43745 |
| 서울 양천구 | 11470 | 진천군 | 43750 |
| 서울 영등포구 | 11560 | 청주시 상당구 | 43111 |
| 서울 용산구 | 11170 | 청주시 서원구 | 43112 |
| 서울 은평구 | 11380 | 청주시 청원구 | 43114 |
| 서울 종로구 | 11110 | 청주시 흥덕구 | 43113 |
| 서울 중구 | 11140 | 충주시 | 43130 |
| 서울 중랑구 | 11260 | 계룡시 | 44250 |
| 부산 강서구 | 26440 | 공주시 | 44150 |
| 부산 금정구 | 26410 | 금산군 | 44710 |
| 부산 기장군 | 26710 | 논산시 | 44230 |
| 부산 남구 | 26290 | 당진시 | 44270 |
| 부산 동구 | 26170 | 보령시 | 44180 |
| 부산 동래구 | 26260 | 부여군 | 44760 |
| 부산 부산진구 | 26230 | 서산시 | 44210 |
| 부산 북구 | 26320 | 서천군 | 44770 |
| 부산 사상구 | 26530 | 아산시 | 44200 |
| 부산 사하구 | 26380 | 예산군 | 44810 |
| 부산 서구 | 26140 | 천안시 동남구 | 44131 |
| 부산 수영구 | 26500 | 천안시 서북구 | 44133 |
| 부산 연제구 | 26470 | 청양군 | 44790 |
| 부산 영도구 | 26200 | 태안군 | 44825 |
| 부산 중구 | 26110 | 홍성군 | 44800 |
| 부산 해운대구 | 26350 | 고창군 | 45790 |
| 대구 남구 | 27200 | 군산시 | 45130 |
| 대구 달서구 | 27290 | 김제시 | 45210 |
| 대구 달성군 | 27710 | 남원시 | 45190 |
| 대구 동구 | 27140 | 무주군 | 45730 |
| 대구 북구 | 27230 | 부안군 | 45800 |
| 대구 서구 | 27170 | 순창군 | 45770 |
| 대구 수성구 | 27260 | 완주군 | 45710 |
| 대구 중구 | 27110 | 익산시 | 45140 |
| 인천 강화군 | 28710 | 임실군 | 45750 |
| 인천 계양구 | 28245 | 장수군 | 45740 |
| 인천 남동구 | 28200 | 전주시 덕진구 | 45113 |
| 인천 동구 | 28140 | 전주시 완산구 | 45111 |
| 인천 미추홀구 | 28177 | 정읍시 | 45180 |
| 인천 부평구 | 28237 | 진안군 | 45720 |
| 인천 서구 | 28260 | 강진군 | 46810 |
| 인천 연수구 | 28185 | 고흥군 | 46770 |
| 인천 옹진군 | 28720 | 곡성군 | 46720 |
| 인천 중구 | 28110 | 광양시 | 46230 |
| 광주 광산구 | 29200 | 구례군 | 46730 |
| 광주 남구 | 29155 | 나주시 | 46170 |
| 광주 동구 | 29110 | 담양군 | 46710 |
| 광주 북구 | 29170 | 목포시 | 46110 |
| 광주 서구 | 29140 | 무안군 | 46840 |
| 대전 대덕구 | 30230 | 보성군 | 46780 |
| 대전 동구 | 30110 | 순천시 | 46150 |
| 대전 서구 | 30170 | 신안군 | 46910 |
| 대전 유성구 | 30200 | 여수시 | 46130 |
| 대전 중구 | 30140 | 영광군 | 46870 |
| 울산 남구 | 31140 | 영암군 | 46830 |
| 울산 동구 | 31170 | 완도군 | 46890 |
| 울산 북구 | 31200 | 장성군 | 46880 |
| 울산 울주군 | 31710 | 장흥군 | 46800 |
| 울산 중구 | 31110 | 진도군 | 46900 |
| 세종특별자치시 | 36110 | 함평군 | 46860 |
| 가평군 | 41820 | 해남군 | 46820 |
| 고양시 덕양구 | 41281 | 화순군 | 46790 |
| 고양시 일산동구 | 41285 | 경산시 | 47290 |
| 고양시 일산서구 | 41287 | 경주시 | 47130 |
| 과천시 | 41290 | 고령군 | 47830 |
| 광명시 | 41210 | 구미시 | 47190 |
| 광주시 | 41610 | 군위군 | 47720 |
| 구리시 | 41310 | 김천시 | 47150 |
| 군포시 | 41410 | 문경시 | 47280 |
| 김포시 | 41570 | 봉화군 | 47920 |
| 남양주시 | 41360 | 상주시 | 47250 |
| 동두천시 | 41250 | 성주군 | 47840 |
| 부천시 | 41190 | 안동시 | 47170 |
| 성남시 분당구 | 41135 | 영덕군 | 47770 |
| 성남시 수정구 | 41131 | 영양군 | 47760 |
| 성남시 중원구 | 41133 | 영주시 | 47210 |
| 수원시 권선구 | 41113 | 영천시 | 47230 |
| 수원시 영통구 | 41117 | 예천군 | 47900 |
| 수원시 장안구 | 41111 | 울릉군 | 47940 |
| 수원시 팔달구 | 41115 | 울진군 | 47930 |
| 시흥시 | 41390 | 의성군 | 47730 |
| 안산시 단원구 | 41273 | 청도군 | 47820 |
| 안산시 상록구 | 41271 | 청송군 | 47750 |
| 안성시 | 41550 | 칠곡군 | 47850 |
| 안양시 동안구 | 41173 | 포항시 남구 | 47111 |
| 안양시 만안구 | 41171 | 포항시 북구 | 47113 |
| 양주시 | 41630 | 거제시 | 48310 |
| 양평군 | 41830 | 거창군 | 48880 |
| 여주시 | 41670 | 고성군 | 48820 |
| 연천군 | 41800 | 김해시 | 48250 |
| 오산시 | 41370 | 남해군 | 48840 |
| 용인시 기흥구 | 41463 | 밀양시 | 48270 |
| 용인시 수지구 | 41465 | 사천시 | 48240 |
| 용인시 처인구 | 41461 | 산청군 | 48860 |
| 의왕시 | 41430 | 양산시 | 48330 |
| 의정부시 | 41150 | 의령군 | 48720 |
| 이천시 | 41500 | 진주시 | 48170 |
| 파주시 | 41480 | 창녕군 | 48740 |
| 평택시 | 41220 | 창원시 마산합포구 | 48125 |
| 포천시 | 41650 | 창원시 마산회원구 | 48127 |
| 하남시 | 41450 | 창원시 성산구 | 48123 |
| 화성시 | 41590 | 창원시 의창구 | 48121 |
| 강릉시 | 42150 | 창원시 진해구 | 48129 |
| 고성군 | 42820 | 통영시 | 48220 |
| 동해시 | 42170 | 하동군 | 48850 |
| 삼척시 | 42230 | 함안군 | 48730 |
| 속초시 | 42210 | 함양군 | 48870 |
| 양구군 | 42800 | 합천군 | 48890 |
| 양양군 | 42830 | 서귀포시 | 50130 |
| 영월군 | 42750 | 제주시 | 50110 |

### 3) 특정 지역의 벡터 데이터만 선택하기

#### 표현식 입력창 열기

속성 테이블의 툴바 버튼에서 `표현식` 아이콘을 클릭한다.

![img](/images/posts/2023/0904/work06.png)

#### 표현식 입력하기

이 예제에서 추출하고자 하는 `진주시`의 법정동 코드는 `48170`이므로 아래와 같이 표현식을 작성한다.

```py
"필드이름" = 값
```

여기서는 `"COL_ADM_SE"=48170`이라고 입력하면 된다.

표현식을 입력한 후 화면 우측 하단의 `객체 선택` 버튼을 클릭하고 이어서 `닫기` 버튼을 클릭한다.

![img](/images/posts/2023/0904/work07.png)

#### 선택 결과 확인

속성 테이블 창을 닫고 나면 아래와 같이 해당 조건에 맞는 벡터 영역만 선택된 것을 볼 수 있다.

![img](/images/posts/2023/0904/work08.png)

### 4) 선택된 벡터 내보내기

#### Export

표현식에 맞는 영역이 선택되어 있는 상태에서 화면 좌측의 레이어 창을 통해 작업중인 레이어를 마우스 우클릭한 후 `Export > 선택한 객체를 다른 이름으로 저장` 메뉴를 선택한다.

![img](/images/posts/2023/0904/work09.png)

#### 설정값 지정

❶ 파일의 포맷(형식)을 `ESRI shapefile`로 지정하고, ❷ 파일이 저장될 경로를 지정해 준다. ❸ 화면 하단의 `저장된 파일을 지도에 추가` 항목을 체크하면 해당 영역을 별도의 파일로 저장함과 동시에 자동으로 레이어로 추가된다. ❹ 설정이 다 되었다면 저장버튼을 누른다.

![img](/images/posts/2023/0904/work10.png)

#### 결과 확인

탐색기와 레이어 창을 통해 내보내어 진 진주시 데이터를 확인할 수 있다. 이제 처음에 추가했더 경상남도 전체 데이터는 필요 없어졌으므로 제거한다.

![img](/images/posts/2023/0904/work11.png)


# #03. 텍스트 데이터(csv) 추가하기

수업시간에 배포되는 `경상남도_진주시_공중화장실.csv` 파일을 작업 폴더에 배치한 상태에서 진행한다.

## 1. 툴바 열기

메뉴바에서 `보기 > 툴바 > 레이어 관리 툴바`를 선택하면 아래와 같은 툴바가 표시된다. 표시 위치는 시스템마다 다를 수 있다.

툴바의 왼쪽 가장자리(세로로 표시된 경우 상단 가장자리)를 클릭한 상태에서 원하는 위치로 이동시킬 수 있다.

![img](/images/posts/2023/0904/work12.png)

## 2. CSV 파일 추가하기

### 메뉴 선택 방법 (1)

`레이어 관리 툴바`에서 쉼표 모양의 아이콘(`구분자로 분리된 텍스트`) 버튼을 클릭하여 CSV 데이터를 추가하는 창을 연다.

![img](/images/posts/2023/0904/work13.png)

### 메뉴 선택 방법 (2)

다른 방법으로는 메뉴바에서 `레이어 > 레이어 추가 > 구분자로 분리된 텍스트` 메뉴를 선택할 수 있다.

![img](/images/posts/2023/0904/work14.png)

### CSV 파일 등록하기

❶ 등록할 CSV파일을 선택하고 ❷ 파일의 인코딩을 지정한다.

❸ CSV 파일에 위/경도의 좌표값이 포함되어 있다면 `포인트 좌표`를 선택한다.

❹ `x`에 경도, `y`에 위도를 연결하고 ❺ 좌표계를 `WGS 84`로 맞춰준다.

❻ CSV의 각 필드드에 맞는 데이터 타입이 연결되어 있는지 확인하고 수정할 항목이 있다면 직접 변경한다.

❼ 선택이 완료 되었다면 `추가` 버튼을 누르고 창을 닫는다.

![img](/images/posts/2023/0904/work15.png)

#### 등록 결과 과면

CSV 파일의 데이터가 Point로 등록된 것을 볼 수 있다.

![img](/images/posts/2023/0904/work16.png)

### CSV 데이터를 벡터로 저장

CSV 파일의 경우 매번 위와 같은 과정을 거쳐 등록해야 한다. 만약 영구적으로 저장하고자 한다면 CSV 파일의 내용을 벡터 데이터로 내보내야 한다.

![img](/images/posts/2023/0904/work17.png)

앞서 진행한 것과 동일하게 shape 파일로 내보내면 이후 이 파일을 재사용할 수 있다.

![img](/images/posts/2023/0904/work18.png)

### CSV 레이어 삭제

벡터 데이터가 추가되었으므로 CSV 파일은 필요 없어졌다.

레이어 항목에 마우스를 올리면 원본 파일의 경로가 팝업으로 표시된다.

항목을 확인하여 CSV 형식의 레이어를 삭제한다.

![img](/images/posts/2023/0904/work19.png)

## 3. 아이콘 변경하기

### 심볼 변경

최종적으로 등록되어 있는 `경상남도_진주시_공중화장실` 레이어의 `속성`창을 열고 왼쪽의 메뉴에서 `심볼`을 선택한다.

`심볼`화면에 표시되는 `단순 마커`를 선택한 상태에서 `심볼 레이어 유형`을 `레스터 이미지 마커로 변경한다.`

![img](/images/posts/2023/0904/work24.png)

### 아이콘 이미지 설정

❶ 아이콘 이미지 파일을 지정하고 ❷ 아이콘의 크기를 적절한 값으로 설정한다. (여러번 수정할 수 있다.)

![img](/images/posts/2023/0904/work25.png)

# #04. 엑셀 데이터 추가하기

## 1. 플러그인 설치

xlsx 형식의 데이터는 플러그인을 설치해야 사용할 수 있다.

메뉴바에서 `플러그인 > 플러그인 관리 및 설치` 항목을 선택한다.

❶ 플러그인 설치 화면이 나타나면 왼쪽 메뉴에서 `모두`를 선택하고 ❷ `Spreadsheet Layers`를 검색한다. (보통 3~4글자만 입력하면 검색된다.)

❸ 검색 결과로 나타나는 항목에서 `Spreadsheet Layers`를 선택하고 ❹ 화면 우측 하단의 `플러그인 설치`버튼을 누른다.

설치가 완료되면 창을 닫는다.

![img](/images/posts/2023/0904/work20.png)

## 2. 엑셀 데이터 가져오기

### 1) Spreadsheet Layers 추가하기

플러그인 설치가 완료되면 `레이어 관리 툴바`에 `Add Spreadsheet Layers...` 버튼이 추가된다. 이 버튼을 누른다.

![img](/images/posts/2023/0904/work21.png)

### 2) 정보 입력하기

❶ 등록하고자 하는 엑셀 파일을 선택한다.

❷ 엑셀파일 내의 sheet 이름과 QGIS에 등록될 레이어 이름을 지정한다.

❸ 엑셀 파일에 위,경도가 있다면 `Geometry` 항목을 체크하고 ❹ `X field`에 위도를, `Y field`에 경도를 연결한다.

❺ 엑셀의 필드별로 데이터 타입이 올바르게 선택되어 있는지 확인하고 필요하다면 직접 수정한다.

❻ 입력이 완료되면 `OK`를 누른다.

![img](/images/posts/2023/0904/work22.png)

### 3) 엑셀 레이어를 백터 데이터로 내보내기

CSV 파일의 경우와 동일하게 엑셀 데이터를 벡터 형식으로 Export 한다.

![img](/images/posts/2023/0904/work23.png)

Export 된 레이어가 추가되면 기존의 엑셀 레이어는 삭제한다. 

## 3. 아이콘 변경하기

CSV 데이터의 경우와 같은 과정을 거쳐서 마커를 적절한 아이콘 이미지로 변경해 준다.

# #05. 배경 지도 설정하기

## 1. 구글 일반도 추가

탐색기의 `XYZ Tiles`에서 `구글 일반도`를 레이어로 추가하고 맨 밑으로 배치한다.

(`XYZ Tiles`의 항목 추가는 이전 글에서 소개한 바 있다.)

![img](/images/posts/2023/0904/work27.png)

## 2. 진주시 레이어 색상 변경

전주시 경계도 레이어의 속성창을 열어 배경색상을 임의의 색상으로 변경하고 투명도를 낮춰준다.

![img](/images/posts/2023/0904/work28.png)

### 결과 화면

![img](/images/posts/2023/0904/work29.png)

# #06. 작업 결과를 이미지로 저장하기

메뉴바에서 `프로젝트 > 가져오기/내보내기 > 지도를 이미지로 내보내기` 메뉴를 선택한다.

![img](/images/posts/2023/0904/work30.png)

해상도를 `300 dpi`로 설정하고 `Save` 버튼을 눌러서 원하는 위치에 저장한다.

![img](/images/posts/2023/0904/work31.png)

## 최종 완성 지도

![img](/images/posts/2023/0904/result_map.png)

---

# 연습문제

대한민국의 도시를 인구가 많은 순으로 나열하면 상위 5개의 도시는 다음과 같다

| 순위 | 도시 |
|--|--|
| 1 | 서울특별시 |
| 2 | 부산광역시 |
| 3 | 인천광역시 |
| 4 | 대구광역시 |
| 5 | 대전광역시 |

위의 5개 도시 중에서 한 곳을 선정하여 읍면동 단위 행정구분도 위에 도서관의 위치를 표시하는 지도를 제작하시오.

제출 파일에는 지도의 축적과 방위가 함께 표시되어야 합니다.

도서관의 위치는 제공되는 데이터파일을 사용하되, 행정구분도는 직접 구하세요.